# hydrogen_combustion_EDMD
This repository contains the work from my master's Thesis Applications of Kernel EDMD, where Extended Dynamic Mode decomposition is used to model the dynamics of hydrogen combustion in a CSTR. Supervisors: Dr. Felix Deitrich and Erik Bolanger (M.sc.)
# Overview
The goal of this project is to use the EDMD method to model hydrogen combustion data and predict the dynamics with starting conditions outside of those used to form the original dataset. The capabilities of this algorithm as in any machine learning application are extremely sensitive to the hyperparameters and the choice of functions in the EDMD function library. The EDMD function libarary is represented by a kernel functions which can contain free paramters which define the type of functions in the library.  These hyperparmeters are the number of eigenfunctions retained after EDMD, the kernel free partmers (which indirectly relate to the functions in the function library), and the number of data points used in the algorithm. To find the proper parameter settings an grid search capability is integrated to perform a large grained search of possible paramter combinations. Once that has been performed, the kernel parameters can be refined even more precisely using a gradient descent training method with a loss function which calculates the difference between the true data values and the predicted values from the EDMD method. The results of the thesis work show that becasue the loss landscape is full to many local minimum, the method does not always converge to an optimal parameter. Additionally, it is extremely easy to overfit the data, so it is critical to implement some sort of cross validation; however traditional cross validation approaches are not appropriate due to the time dependency of the data. This requires an approach where the accuracy of predicted dynamic tradjectories using initial conditions outside of the original data range are evaluated (these new dynamic tradjectories are called "Out of sample data"). An optimization of this value as well as an optimization of the accuracy of hte in-sample predictions is required to adequately model the data. The Out of sample data accuracy measurment is implemented into the grid search, but not implemented into the kernel learning algorithm. 
# Details
The Cantera Library  is used to model hydrogen combustion in a CSTR reactor where the concentration of hydrogen is tracked over time. Additionally, a less complex dynamical system representing a hopf bifurcation is available as a test of concept.The data from each dynamic system is generated by solving a system of governing equations using a classical Runge Kutta solver. The data is organized into a time-series format where EDMD is performed using different kernels which represent different function libraries. The kernels available are linear, polynomial, Radial Basis, Sigmoid, and some combination kernels. The kernels which have one or two free parameters can be learned using a standard gradient descent algorithm. 
# Code structure

# References
David G. Goodwin, Harry K. Moffat, Ingmar Schoegl, Raymond L. Speth, and Bryan W. Weber. Cantera: An object-oriented software toolkit for chemical kinetics, thermodynamics, and transport processes. https://www.cantera.org, 2023. Version 3.0.0. doi:10.5281/zenodo.8137090
